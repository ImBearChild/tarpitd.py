<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Tarpitd.py.1 - Tarpitd.py</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/fontawesome.min.css" rel="stylesheet">
        <link href="../css/brands.min.css" rel="stylesheet">
        <link href="../css/solid.min.css" rel="stylesheet">
        <link href="../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">Tarpitd.py</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle active" aria-current="page" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Manual</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="./" class="dropdown-item active" aria-current="page">Tarpitd.py.1</a>
</li>
                                    
<li>
    <a href="../tarpitd.conf.5/" class="dropdown-item">Tarpitd.conf.5</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href=".." class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../tarpitd.conf.5/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="2"><a href="#name" class="nav-link">NAME</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#synopsis" class="nav-link">SYNOPSIS</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#description" class="nav-link">DESCRIPTION</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#options" class="nav-link">OPTIONS</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#tarpit-pattern" class="nav-link">TARPIT PATTERN</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#examples" class="nav-link">EXAMPLES</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#author" class="nav-link">AUTHOR</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h2 id="name">NAME</h2>
<p>tarpitd.py - making a port into tarpit</p>
<h2 id="synopsis">SYNOPSIS</h2>
<pre><code>tarpitd.py [-h] [-r RATE] [-c [FILE]]
    [-s PATTERN:HOST:PORT [PATTERN:HOST:PORT ...]] [--manual]
</code></pre>
<h2 id="description">DESCRIPTION</h2>
<p>tarpitd.py listens on specified network ports and purposefully delays or troubles clients that connect to it. This tool can be used to tie up network connections by delivering slow or malformed responses, potentially keeping client connections open for extended periods.</p>
<h2 id="options">OPTIONS</h2>
<h4 id="-c-config-file"><code>-c, --config FILE</code></h4>
<p>Load configuration from file.</p>
<h4 id="-s-serve-patternhostport-patternhostport"><code>-s, --serve PATTERN:HOST:PORT [PATTERN:HOST:PORT ...]</code></h4>
<p>Start a tarpit pattern on specified host and port. </p>
<p>The name of PATTERN is case-insensitive. For a complete list of supported patterns, see the “TARPIT PATTERN” section below.</p>
<h4 id="-r-rate-rate-limit-rate"><code>-r RATE, --rate-limit RATE</code></h4>
<p>Set data transfer rate limit.</p>
<p>A positive value limits the transfer speed to RATE <em>bytes</em> per second.
A negative value causes the program to send one byte every |RATE| seconds (effectively 1/|RATE| <em>bytes</em> per second).</p>
<h4 id="-manual-manual"><code>--manual MANUAL</code></h4>
<p>Display the built-in manual page. By default, tarpitd.py will open <code>tarpitd.py.1</code>.</p>
<p>Available manual pages include:</p>
<ul>
<li>tarpitd.py.1 : Program usage</li>
<li>tarpitd.conf.5 : Configuration file format</li>
</ul>
<h2 id="tarpit-pattern">TARPIT PATTERN</h2>
<h3 id="http">HTTP</h3>
<h4 id="http_endless_header">http_endless_header</h4>
<p>Tested with: Firefox, Chromium, curl</p>
<p>Sends an endless stream of HTTP header lines (specifically, <code>Set-Cookie:</code>). Some clients will wait indefinitely for the header to end (or for a blank line indicating the end of the headers), while others (like curl) may have header size restrictions and close the connection once the limit is reached.</p>
<h4 id="http_deflate_html_bomb">http_deflate_html_bomb</h4>
<p>Tested with: Firefox, Chromium</p>
<p>Sends a badly formed HTML document compressed using the deflate (zlib) algorithm. Most clients will consume significant CPU resources attempting to parse the malformed HTML.  </p>
<p>Note: The response is always compressed with deflate regardless of client support, as serving uncompressed output might waste bandwidth. When using curl, use the <code>--compressed</code> option to trigger decompression and ensure you have sufficient disk space to handle the decompressed content.</p>
<h4 id="http_deflate_size_bomb">http_deflate_size_bomb</h4>
<p>Tested with: Firefox, Chromium, curl</p>
<p>Feeds the client with a large amount of compressed zero data. The current implementation sends a compressed 1 MB file that decompresses to approximately 1 GB, with added invalid HTML to further confuse the client. </p>
<p>Note: deflate compress algorithm has its maximum compression 
rate limit, at 1030.3:1.</p>
<h3 id="ssh">SSH</h3>
<h4 id="endlessh">endlessh</h4>
<p>Tested with: OpenSSH</p>
<p>endlessh is a well-known SSH tarpit that traps SSH clients by sending endless banner messages. Although named “endlessh”, it does not implement the full SSH protocol; it rather continuously emits banner data. As a result, port scanners (such as nmap and censys) will not mark the port as running a true SSH service.</p>
<h3 id="ssh_trans_hold">ssh_trans_hold</h3>
<p>Tested with: OpenSSH</p>
<p>This tarpit mimics an SSH server's initial handshake by sending valid SSH transport messages and key exchange information (per IETF RFC 4253). However, instead of completing the exchange, it repeatedly sends <code>SSH_MSG_IGNORE</code> messages. Although clients are supposed to ignore these messages according to the standard, the continual stream keeps the connection open indefinitely.  </p>
<p>Note: The implementation advertises itself as OpenSSH 8.9 on Ubuntu and replays a pre-recorded SSH key exchange. Future updates may alter aspects of this behavior.</p>
<h3 id="tls">TLS</h3>
<h4 id="tls_endless_hello_request">tls_endless_hello_request</h4>
<p>Tested with: openssl (cli)</p>
<p>Sends an endless series of HelloRequest messages to the client. According to IETF RFC 5246 (the TLS 1.2 specification), clients should ignore extra HelloRequest messages during the negotiation phase, effectively keeping the connection open. </p>
<h3 id="misc">MISC</h3>
<h4 id="egsh_aminoas">egsh_aminoas</h4>
<p>Tested with: openssh</p>
<p>An alternative to endlessh, this service not only keeps connections open but also adds a cultural touch.</p>
<p>This is not just a service, it symbolizes the hope and enthusiasm of an entire generation summed up in two words sung most famously by Daret Hanakhan: Egsh Aminoas. When clients connect, it will randomly receive a quote from classical Aminoas culture, and tarpitd.py will show you the same quote in log at the same time.</p>
<h2 id="examples">EXAMPLES</h2>
<p>Print this manual:</p>
<pre><code>tarpitd.py --manual
</code></pre>
<p>Start an endlessh tarpit:</p>
<pre><code>tarpitd.py -s endlessh:0.0.0.0:2222
</code></pre>
<p>Start an endless HTTP tarpit with a 2-second per-byte delay:</p>
<pre><code>tarpitd.py -r-2 -s HTTP_ENDLESS_COOKIE:0.0.0.0:8088
</code></pre>
<p>Start an endless HTTP tarpit with a rate limit of 1 KB/s:</p>
<pre><code>tarpitd.py -r1024 -s HTTP_DEFLATE_HTML_BOMB:0.0.0.0:8088
</code></pre>
<p>Start two different HTTP tarpit services concurrently
(the name of pattern is case-insensitive):</p>
<pre><code>tarpitd.py -s http_deflate_html_bomb:127.0.0.1:8080 \
              HTTP_ENDLESS_COOKIE:0.0.0.0:8088
</code></pre>
<h2 id="author">AUTHOR</h2>
<p>Nianqing Yao [imbearchild at outlook.com]</p>
<hr />
<blockquote>
<p>This program was made on the lands of
  the Aminoac people of the Amacinoas Nation. 
  We pay our respects to their Elders, past and present. 
  Sovereignty was never ceded.</p>
</blockquote></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>
        <script src="../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
