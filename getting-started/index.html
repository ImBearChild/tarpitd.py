<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Guide - tarpitd.py</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/fontawesome.min.css" rel="stylesheet">
        <link href="../css/brands.min.css" rel="stylesheet">
        <link href="../css/solid.min.css" rel="stylesheet">
        <link href="../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">tarpitd.py</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="nav-item">
                                <a href="./" class="nav-link active" aria-current="page">Guide</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Manual</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../manual/" class="dropdown-item">Index</a>
</li>
                                    
<li>
    <a href="../manual/tarpitd.py.1/" class="dropdown-item">Tarpitd.py.1</a>
</li>
                                    
<li>
    <a href="../manual/tarpitd.conf.5/" class="dropdown-item">Tarpitd.conf.5</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item">
                                <a href="../about/" class="nav-link">About</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href=".." class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../manual/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/ImBearChild/tarpitd.py/blob/master/docs/getting-started.md" class="nav-link"><i class="fa-brands fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#getting-started" class="nav-link">Getting Started</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#installation" class="nav-link">Installation</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#first-few-tarpits" class="nav-link">First Few Tarpits</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#configuration" class="nav-link">Configuration</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="getting-started">Getting Started</h1>
<h2 id="installation">Installation</h2>
<p><strong>Note:</strong> Tarpitd.py requires <strong>Python 3.11 or higher</strong>!</p>
<p>You don't have to run <code>pip install</code> or clone any repositories—just download the <a href="https://github.com/ImBearChild/tarpitd.py/raw/main/src/tarpitd.py">tarpitd.py</a> script and place it wherever you prefer.</p>
<p>To use it as an executable, move the script to a directory listed in your <code>$PATH</code> (commonly <code>/usr/local/bin</code> or <code>~/.local/bin</code>) and mark it as executable:</p>
<pre><code class="language-bash">chmod +x tarpitd.py
</code></pre>
<p>If you’d rather install it via pip, you can do so with:</p>
<pre><code class="language-bash">python -m pip install git+https://github.com/ImBearChild/tarpitd.py.git@main
</code></pre>
<h2 id="first-few-tarpits">First Few Tarpits</h2>
<h3 id="slowing-down-ssh-brute-force-attacks">Slowing Down SSH Brute-Force Attacks</h3>
<p>SSH ports are frequent targets for brute-force attacks. By converting the SSH port into a “trap,” attackers connecting to the port receive endless banner messages or continuous ignore messages that force them to wait for a response. This significantly lengthens the time required for each attack attempt.</p>
<p><em>Example: Run an SSH tarpit (in endlessh mode) on port 2222 of your machine:</em></p>
<pre><code class="language-bash">tarpitd.py -s endlessh:0.0.0.0:2222
</code></pre>
<p>This setup is effective for defending against SSH brute-force attacks by forcing attackers to spend much longer time on each connection, decreasing the resource they can spend on real SSH daemon.</p>
<h3 id="thwarting-automated-http-scanning-and-crawling">Thwarting Automated HTTP Scanning and Crawling</h3>
<p>Automated tools and crawlers are often used to scan for vulnerabilities and harvest content. </p>
<p>For HTTP services, you can launch a tarpit pattern that sends an endless stream of HTTP headers. This forces scanning tools and crawlers to wait, drastically reducing their efficiency. </p>
<p>For clients connecting via HTTPS/TLS, you can use one of tarpitd.py’s TLS pattern – such as sending a ServerHello messages slowly. In this mode, connected TLS clients (for example, those using OpenSSL for testing or scanning) will eventually time out or declare handshake failures due to prolonged waiting.</p>
<p>tarpitd.py allows you to launch multiple services in a single command, each using a different pattern, listening on different addresses and ports.</p>
<p><em>Example 1: Run both an HTTP tarpit and an TLS tarpit concurrently:</em></p>
<pre><code class="language-bash">tarpitd.py -r -2 -s HTTP_ENDLESS_COOKIE:0.0.0.0:8088 -s tls_slow_hello:127.0.0.1:8443
</code></pre>
<p>In this case, the option <code>-r -2</code> makes the program wait 2 seconds for every byte sent, forcing each malicious request to endure a long delay.</p>
<p>Want to fight back harder? How about sending resource-intensive deflate-compressed data? This pattern will force client consume excessive resources, making them CPU-intensive and memory-intensive.</p>
<p><em>Example 2: Consume client resources using a deflate-compressed HTML bomb:</em></p>
<pre><code class="language-bash">tarpitd.py -r 1024 -s HTTP_DEFLATE_HTML_BOMB:0.0.0.0:8088
</code></pre>
<p>Here, the tool sends a 1 MB compressed package that, when decompressed, may consume up to 1 GB of memory, with invalid HTML can confuse the client. With a rate limit of 1 KB/s, you can control the output flow while imposing heavy resource usage on the client.</p>
<h2 id="configuration">Configuration</h2>
<p>In a real-world scenario, you might need to defend against various types of attacks simultaneously. </p>
<p>Instead of relying solely on command-line options, you can configure tarpitd.py with a dedicated configuration file. The TOML configuration file allows you to define multiple tarpit services with separate settings, such as different tarpit modes, rate limits, bind addresses, and client examination rules. This approach is particularly useful if you need to run several tarpit instances simultaneously, each with its own tailored behavior.</p>
<p><em>Example: Combine examples up</em></p>
<pre><code class="language-toml">[tarpits]
[tarpits.my_cool_ssh_tarpit]
pattern = &quot;ssh_trans_hold&quot;
client_trace=  true
client_valiation=  true 
max_clients = 8152
rate_limit = -2
bind = [{ host = &quot;127.0.0.1&quot;, port = &quot;2222&quot; }]

[tarpits.http_tarpit]
pattern = &quot;HTTP_ENDLESS_COOKIE&quot;
bind = [
  { host = &quot;127.0.0.1&quot;, port = &quot;8080&quot; },
  { host = &quot;::1&quot;, port = &quot;8888&quot; },
]

[tarpits.tls_tarpit]
pattern = &quot;tls_slow_hello&quot;
rate_limit = 1
bind = [
  { host = &quot;127.0.0.1&quot;, port = &quot;8443&quot; },
]

[logging]
client_trace = &quot;./client_trace.log&quot;
</code></pre>
<p>In this configuration:</p>
<ul>
<li>Each tarpit service (e.g., my_cool_ssh_tarpit, http_tarpit, tls_tarpit) is defined with its own settings.</li>
<li>You can customize the bind addresses (host and port), rate limits, client examination, and maximum connection limits individually.</li>
<li>The global [logging] section allows you to log connection details for future analysis.</li>
</ul>
<p>Save it to <code>conf.toml</code>. And run tarpitd.py with it. </p>
<pre><code>tarpitd.py -c ./conf.toml
</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>
        <script src="../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
